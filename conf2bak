#!/bin/bash
# conf2bak
# config saving algorithm

# default
date=$(date +"%y%m%d")
name=$(uname -n)

# check 3 arguments are given #
case $# in
    0) echo "usage: conf2bak [-h|-z|-e|-l|-g|-c location]"
	echo "try: -h for help"
	exit 0
	;;
    1) case "$1" in
        # display help message
	-h) echo "config backup editor @M"
	    echo "usage: conf2bak [-h|-z|-e|-l|-g|-c location]"
	    echo "       -h              displays this text"
	    echo "       -z              copies configs to zero (int hdd)"
	    echo "       -e              copies configs to exil (ext hdd)"
	    echo "       -l              copies configs to local dir"
	    echo "       -g              copies configs to local git repo 'zephyr'"
	    echo "       -c location     copies configs to specified location, path/to/dir"
	    echo "                       important: location must exist! (see mount/blkid)"  
	    exit 0
	    ;;
        # loc = zero
	-z) loc="/media/zero/projects/computer/linux/configs/"$USER"_$name_$date" #$USER gets evaluated via shell later on...
	    ;;
        # loc = exil
	-e) loc="/media/exil/projects/computer/linux/configs/"$USER"_$name_$date"
	    ;;
        # loc = local
	-l) loc=$HOME"/"$USER"_$name_$date"
	    ;;
        # loc = git
	-g) loc=$HOME"/zephyr"
	    ;;
        # error message
	*) echo "invalid option"
	   echo "usage: conf2bak [-h|-z|-e|-c location]"
	   echo "try: -h for help"
	   exit 0
	   ;;
       esac
       ;;
    2) #  loc = custom
       if [ $1 == "-c" ]; then
	   loc="$2/configs_"$USER"_$name_$date"
       fi
       ;;
    *) # error message
       echo "invalid option"
       echo "usage: conf2bak [-h|-z|-e|-c location]"
       echo "try: -h for help"
       exit 0
       ;;
esac

# init location
echo "--- setting up location ---"
mkdir $loc
echo "backup location: $loc"

# copy scripts
echo "--- copy scripts ---"
cp -R $HOME/scripts/* $loc; echo "scripts/"
echo "{"; echo "$(ls $HOME/scripts)"; echo "}"

# copy rcs
echo "--- copy rcs ---"
mkdir $loc/configs
cp -R $HOME/.conky         $loc/configs;        echo ".conky/"
cp $HOME/.emacs            $loc/configs;        echo ".emacs"
cp $HOME/.moc/config       $loc/configs/.moc;   echo ".moc/config > .moc"
cp $HOME/.ripit/config     $loc/configs/.ripit  echo ".ripit/config > .ripit"
cp $HOME/.synergy          $loc/configs;        echo ".synergy"
cp $HOME/.xinitrc          $loc/configs;        echo ".xinitrc"
cp $HOME/.xmonad/xmonad.hs $loc/configs;        echo ".xmonad/xonad.hs"
cp $HOME/.xresources       $loc/configs;        echo ".xresources"
cp $HOME/.zshrc            $loc/configs;        echo ".zshrc"

# copy notes
echo "--- copy notes ---"
cp -R $HOME/notes $loc; echo "notes/"
echo "{"; echo "$(ls $HOME/notes)"; echo "}"

# cleaning up: remove backups, maybe exclude somehow bevor cp?
rm "$loc/*~"; rm "$loc/*#"
rm "$loc/.*~"; rm "$loc/.*#"